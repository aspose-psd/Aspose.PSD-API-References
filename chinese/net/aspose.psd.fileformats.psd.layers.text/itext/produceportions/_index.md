---
title: ProducePortions
second_title: Aspose.PSD for .NET API 参考
description: 使用输入或默认参数生成新部分
type: docs
weight: 60
url: /zh/net/aspose.psd.fileformats.psd.layers.text/itext/produceportions/
---
## IText.ProducePortions method

使用输入或默认参数生成新部分。

```csharp
public ITextPortion[] ProducePortions(string[] portionsOfText, ITextStyle stylePrototype, 
    ITextParagraph paragraphPrototype)
```

| 范围 | 类型 | 描述 |
| --- | --- | --- |
| portionsOfText | String[] | 要创建新的文本部分[`ITextPortion`](../../itextportion)。 |
| stylePrototype | ITextStyle | 如果不为空，将在新的 &lt;see. Cref="ITextPortion" /&gt;，否则为默认值。 |
| paragraphPrototype | ITextParagraph | 如果不为空，将在新的 &lt;see. Cref="ITextPortion" /&gt;，否则为默认值。 |

### 返回值

根据输入参数返回新部分[`ITextPortion`](../../itextportion)。

### 例子

下面的例子演示了如何在 Aspose.PSD 的一个文本层中渲染不同的样式

```csharp
[C#]

string sourceFile = "text212.psd";
string etalonFile = "Ethalon_text212.psd";
string outputFile = "Output_text212.psd";

using (var img = (PsdImage)Image.Load(sourceFile))
{
    TextLayer textLayer = (TextLayer)img.Layers[1];
    IText textData = textLayer.TextData;
    ITextStyle defaultStyle = textData.ProducePortion().Style;
    ITextParagraph defaultParagraph = textData.ProducePortion().Paragraph;
    defaultStyle.FillColor = Color.DimGray;
    defaultStyle.FontSize = 51;

    textData.Items[1].Style.Strikethrough = true;

    ITextPortion[] newPortions = textData.ProducePortions(
        new string[]
        {
          "E=mc", "2\r", "Bold", "Italic\r",
          "Lowercasetext"
        },
        defaultStyle,
        defaultParagraph);

    newPortions[0].Style.Underline = true; // 编辑文本样式“E=mc”
    newPortions[1].Style.FontBaseline = FontBaseline.Superscript; // 编辑文本样式 "2\r"
    newPortions[2].Style.FauxBold = true; // 编辑文本样式“粗体”
    newPortions[3].Style.FauxItalic = true; // 编辑文本样式“斜体\r”
    newPortions[3].Style.BaselineShift = -25; // 编辑文本样式“斜体\r”
    newPortions[4].Style.FontCaps = FontCaps.SmallCaps; // 编辑文本样式“小写文本”

    foreach (var newPortion in newPortions)
    {
        textData.AddPortion(newPortion);
    }

    textData.UpdateLayerData();
    img.Save(outputFile);
}
```

### 也可以看看

* interface [ITextPortion](../../itextportion)
* interface [ITextStyle](../../itextstyle)
* interface [ITextParagraph](../../itextparagraph)
* interface [IText](../../itext)
* 命名空间 [Aspose.PSD.FileFormats.Psd.Layers.Text](../../itext)
* 部件 [Aspose.PSD](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.PSD.dll -->
